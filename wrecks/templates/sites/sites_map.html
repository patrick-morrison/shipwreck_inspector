{% extends 'wrecks/base.html' %}
{% block content %}

<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>

   <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.css">
   <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.0.3/dist/MarkerCluster.Default.css">
   <script src="https://unpkg.com/leaflet.markercluster@1.0.3/dist/leaflet.markercluster.js"></script>
  </head>

  <style>
#map
{
    width: 100px;
    height:100px;
    min-height: 100%;
    min-width: 100%;
    display: block;
}

html, body
{
    height: 100%;
}

#map-holder{
    height: 100%;
}

.fill
{
    min-height: 100%;
    height: 100%;
    width: 100%;
    max-width: 100%;
}

.container{
    max-width:60em;
    padding: 0.2em;
}

  </style>

  <div id="map-holder">
  <div class="container fill">
    <div id="map"></div>
  </div>
  </div>
  
  <script>
    var map = L.map('map').setView([-31, 115], 7);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 14
  }).addTo(map);
  
  
  var wrecks = new L.geoJSON().bindTooltip(function (layer) {
    return layer.feature.properties.name + " " + layer.feature.properties.sunk});

    var markers = L.markerClusterGroup();
    markers.addLayer(wrecks);
    markers.addTo(map);
    wrecks.addTo(map);
  
  $.ajax({
  dataType: "json",
  url: "{% url 'sites_json'%}",
  success: function(data) {
      $(data.features).each(function(key, data) {
        wrecks.addData(data);
      });
  }
  }).error(function() {});
  
  </script>

{% endblock %}